<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>Chatアプリ</title>
<script src="js/jquery-2.1.3.min.js"></script>
<link rel="stylesheet" href="css/sample.css">
</head>
<body>
    <canvas id="canvas"></canvas>
    <section id="body>
      /* 実際のbodyはここに書く */
    </section>
  </body>
<body>
    
    <div>
        <div class="box1">
            name:<input type="text" id="uname">
        </div>
        <div>
            <textarea id="text" cols="30" rows="10"></textarea>
            <button id="send">送信</button>
        </div>
        <div id="output" style="height: 300px; overflow: auto;border: 1px solid green;"></div>
    </div>
    <canvas id="c"></canvas>
    <script>
    var s = window.screen;
    var c = document.getElementById("c");
    var ctx = c.getContext("2d");
    
    var width = c.width = s.width;
    var height = c.height = s.height;
    
    var matrix = "観自在菩薩行深般若波羅蜜多時照見五蘊皆空度一切苦厄舎利子色不異空空不異色色即是空空即是色受想行識亦復如是舎利子是諸法空相不生不滅不垢不浄不増不減是故空中無色無受想行識無眼耳鼻舌身意無色声香味触法無眼界乃至無意識界無無明亦無無明尽乃至無老死亦無老死尽無苦集滅道無智亦無得以無所得故菩提薩埵依般若波羅蜜多故心無罣礙無罣礙故無有恐怖遠離一切顛倒夢想究竟涅槃三世諸仏依般若波羅蜜多故得阿耨多羅三藐三菩提故知般若波羅蜜多是大神呪是大明呪是無上呪是無等等呪能除一切苦真実不虚故説般若波羅蜜多呪即説呪日羯諦羯諦波羅羯諦波羅僧羯諦菩提薩婆訶般若心経";
    
    matrix = matrix.split("");
    
    var font_size = 10;
    var columns = c.width / font_size;
    var drops = [];
    for(var x = 0; x < columns; x++)
        drops[x] = 1; 
    
    function draw() {
        ctx.fillStyle = "rgba(0, 0, 0, 0.04)";
        ctx.fillRect(0, 0, c.width, c.height);
        ctx.fillStyle = "#0F0";
        ctx.font = font_size + "px arial";
        for( var i = 0; i < drops.length; i++ ) {
            var text = matrix[ Math.floor( Math.random() * matrix.length ) ];
            ctx.fillText(text, i * font_size, drops[i] * font_size);
            if( drops[i] * font_size > c.height && Math.random() > 0.975 )
                drops[i] = 0;
            drops[i]++;
        }
    }
    setInterval( draw, 35 );
    
    </script>
    


<!-- コンテンツ表示画面 -->
<!-- <div>
    <div class="box1">
        名前:<input type="text" id="uname">
    </div>
    <div>
        <textarea id="text" cols="30" rows="10"></textarea>
        <button id="send">送信</button>
    </div>
    <div id="output" style="height: 300px; overflow: auto;border: 1px solid green;"></div>
</div> -->








<!--/ コンテンツ表示画面 -->



<!-- JQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<!-- JQuery -->


<!--** 以下Firebase **-->

<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.1.2/firebase.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->

<script>
  // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyDU71s9FCDltILhYrJKQyKvhf1_YcRgeRg",
    authDomain: "demo1-8dca1.firebaseapp.com",
    projectId: "demo1-8dca1",
    storageBucket: "demo1-8dca1.appspot.com",
    messagingSenderId: "357493581022",
    appId: "1:357493581022:web:ae8e393800bad371f90e4f"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);

  const ref = firebase.database().ref();
  //送信イベント
  $("#send").on("click",function(){
      const uname = $("#uname").val();
      const text = $("#text").val();
      const msg = {
          uname: uname, //送信名:値
          text: text   //送信名:値
      };
      ref.push(msg);     //サーバーにpush
  });
//受信イベント
ref.on("child_added",function(data){
    const v = data.val();  //dataオブジェクトの中のdata取得
    const k = data.key;  //keyを取得
    const h = '<p>'+v.uname+'<br>'+v.text+'</p>';
    $("#output").append(h);
    const tdiv = document.getElementById("output");
    tdiv.scrollTop = tdiv.scrollHeight;
});





//enterで送信イベント

$("#text").on("keydown",function(e){
    console.log(e.keyCode);
    if(e.keyCode==13){
        const uname = $("#uname").val();
        const text = $("#text").val();
        const msg = {
          uname: uname, //送信名:値
          text: text   //送信名:値
        };
        ref.push(msg);
    }
});

</script>











</body>
</html>
































